"use strict";(globalThis.webpackChunkaaronwolf_dev=globalThis.webpackChunkaaronwolf_dev||[]).push([[8123],{4612:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"coding/python/language_reference/coroutine","title":"coroutine","description":"Properties","source":"@site/docs/coding/python/language_reference/coroutine.md","sourceDirName":"coding/python/language_reference","slug":"/coding/python/language_reference/coroutine","permalink":"/docs/coding/python/language_reference/coroutine","draft":false,"unlisted":false,"editUrl":"https://github.com/wolf-math/aaronwolfdev/tree/main/docs/coding/python/language_reference/coroutine.md","tags":[],"version":"current","sidebarPosition":24,"frontMatter":{"title":"coroutine","sidebar_position":24},"sidebar":"tutorialSidebar","previous":{"title":"method","permalink":"/docs/coding/python/language_reference/method"},"next":{"title":"generator","permalink":"/docs/coding/python/language_reference/generator"}}');var i=r(4848),o=r(8453);const c={title:"coroutine",sidebar_position:24},d=void 0,s={},a=[{value:"Properties",id:"properties",level:2},{value:"Definition",id:"definition",level:2},{value:"Creating coroutines",id:"creating-coroutines",level:2},{value:"Running coroutines",id:"running-coroutines",level:2},{value:"Coroutine methods and attributes",id:"coroutine-methods-and-attributes",level:2},{value:"<code>send(value)</code>",id:"sendvalue",level:3},{value:"<code>throw(exc)</code>",id:"throwexc",level:3},{value:"<code>close()</code>",id:"close",level:3},{value:"Attributes",id:"attributes",level:3},{value:"Dunder methods",id:"dunder-methods",level:2}];function l(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> import inspect\n>>> async def demo(): return 1\n>>> coro = demo()\n>>> [name for name in dir(coro) if not name.startswith(\"__\")]\n['close', 'cr_await', 'cr_code', 'cr_frame', 'cr_origin', 'cr_running', 'cr_suspended', 'send', 'throw']\n"})}),"\n",(0,i.jsx)(n.h2,{id:"definition",children:"Definition"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"coroutine"})," is an awaitable object produced by calling an ",(0,i.jsx)(n.code,{children:"async def"})," function. It represents work that will complete in the future and must be awaited, scheduled (e.g., via ",(0,i.jsx)(n.code,{children:"asyncio.create_task"}),"), or run in an event loop. Coroutine objects are single-use: once awaited to completion, they cannot be awaited again."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import asyncio\n\nasync def fetch():\n    return "done"\n\nasync def main():\n    result = await fetch()   # await the coroutine\n    print(result)\n\nasyncio.run(main())\n'})}),"\n",(0,i.jsx)(n.h2,{id:"creating-coroutines",children:"Creating coroutines"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"async def add(a, b):\n    return a + b\n\ncoro = add(1, 2)  # calling an async function creates a coroutine object\n"})}),"\n",(0,i.jsx)(n.p,{children:"Coroutines cannot be executed with a normal function call; they must be awaited or scheduled in an event loop:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import asyncio\n\nasync def main():\n    value = await add(1, 2)\n    print(value)  # 3\n\nasyncio.run(main())\n"})}),"\n",(0,i.jsx)(n.h2,{id:"running-coroutines",children:"Running coroutines"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"await coro"})," \u2014 run inside another coroutine."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"asyncio.run(coro)"})," \u2014 run from synchronous code (creates and manages the event loop)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"asyncio.create_task(coro)"})," \u2014 schedule concurrently; returns a Task."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import asyncio\n\nasync def work(name, delay):\n    await asyncio.sleep(delay)\n    return name\n\nasync def main():\n    t1 = asyncio.create_task(work(\"a\", 1))\n    t2 = asyncio.create_task(work(\"b\", 0.5))\n    results = await asyncio.gather(t1, t2)\n    print(results)  # ['a', 'b']\n\nasyncio.run(main())\n"})}),"\n",(0,i.jsx)(n.h2,{id:"coroutine-methods-and-attributes",children:"Coroutine methods and attributes"}),"\n",(0,i.jsx)(n.h3,{id:"sendvalue",children:(0,i.jsx)(n.code,{children:"send(value)"})}),"\n",(0,i.jsx)(n.p,{children:"Resumes the coroutine, sending a value into it (advanced; rarely used directly\u2014mostly for generator-based coroutines)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> async def consumer():\n...     x = await asyncio.sleep(0, result=1)\n...     return x\n"})}),"\n",(0,i.jsx)(n.h3,{id:"throwexc",children:(0,i.jsx)(n.code,{children:"throw(exc)"})}),"\n",(0,i.jsx)(n.p,{children:"Raises the given exception inside the coroutine."}),"\n",(0,i.jsx)(n.h3,{id:"close",children:(0,i.jsx)(n.code,{children:"close()"})}),"\n",(0,i.jsxs)(n.p,{children:["Stops the coroutine, raising ",(0,i.jsx)(n.code,{children:"GeneratorExit"})," inside it."]}),"\n",(0,i.jsx)(n.h3,{id:"attributes",children:"Attributes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cr_await"})," \u2014 current object being awaited (or ",(0,i.jsx)(n.code,{children:"None"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cr_running"})," \u2014 ",(0,i.jsx)(n.code,{children:"True"})," while executing."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cr_frame"})," / ",(0,i.jsx)(n.code,{children:"cr_code"})," \u2014 frame and code object (debugging)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cr_origin"})," / ",(0,i.jsx)(n.code,{children:"cr_suspended"})," \u2014 metadata for where it was created / if suspended."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dunder-methods",children:"Dunder methods"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Dunder Method"}),(0,i.jsx)(n.th,{children:"Operation"}),(0,i.jsx)(n.th,{children:"Example (normal syntax)"}),(0,i.jsx)(n.th,{children:"Example (dunder call)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__await__"})}),(0,i.jsx)(n.td,{children:"Make coroutine awaitable"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"await coro"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"coro.__await__()"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__iter__"})}),(0,i.jsx)(n.td,{children:"Await protocol (internal)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"await coro"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"coro.__iter__()"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__next__"})}),(0,i.jsx)(n.td,{children:"Iteration step (internal)"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.em,{children:"(implicit during await)"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"coro.__next__()"})})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>d});var t=r(6540);const i={},o=t.createContext(i);function c(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);