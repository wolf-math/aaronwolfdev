"use strict";(globalThis.webpackChunkaaronwolf_dev=globalThis.webpackChunkaaronwolf_dev||[]).push([[2903],{6440:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"coding/python/user_guide/oop/dunder_methods","title":"Dunder methods","description":"What are dunder methods?","source":"@site/docs/coding/python/user_guide/oop/dunder_methods.md","sourceDirName":"coding/python/user_guide/oop","slug":"/coding/python/user_guide/oop/dunder_methods","permalink":"/docs/coding/python/user_guide/oop/dunder_methods","draft":false,"unlisted":false,"editUrl":"https://github.com/wolf-math/aaronwolfdev/tree/main/docs/coding/python/user_guide/oop/dunder_methods.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Dunder methods","sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Polymorphism","permalink":"/docs/coding/python/user_guide/oop/polymorphism"},"next":{"title":"Class attributes","permalink":"/docs/coding/python/user_guide/oop/class_attributes"}}');var t=s(4848),r=s(8453);const d={title:"Dunder methods",sidebar_position:7},o=void 0,l={},c=[{value:"What are dunder methods?",id:"what-are-dunder-methods",level:2},{value:"Why this matters",id:"why-this-matters",level:2},{value:"Object construction: <code>__init__</code>",id:"object-construction-__init__",level:2},{value:"String representation: <code>__repr__</code> and <code>__str__</code>",id:"string-representation-__repr__-and-__str__",level:2},{value:"Container behavior: <code>__len__</code>, <code>__getitem__</code>, <code>__contains__</code>",id:"container-behavior-__len__-__getitem__-__contains__",level:2},{value:"<code>__len__</code>",id:"__len__",level:3},{value:"<code>__getitem__</code> and iteration",id:"__getitem__-and-iteration",level:3},{value:"<code>__contains__</code>",id:"__contains__",level:3},{value:"Operator overloading: <code>__add__</code>, <code>__eq__</code>, etc.",id:"operator-overloading-__add__-__eq__-etc",level:2},{value:"Equality: <code>__eq__</code>",id:"equality-__eq__",level:3},{value:"Addition: <code>__add__</code>",id:"addition-__add__",level:3},{value:"Making your class iterable: <code>__iter__</code>",id:"making-your-class-iterable-__iter__",level:2},{value:"Context managers: <code>__enter__</code> and <code>__exit__</code>",id:"context-managers-__enter__-and-__exit__",level:2},{value:"When (and when not) to use dunder methods",id:"when-and-when-not-to-use-dunder-methods",level:2},{value:"Summary",id:"summary",level:2}];function _(e){const n={br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"what-are-dunder-methods",children:"What are dunder methods?"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Dunder methods"})," (short for ",(0,t.jsx)(n.em,{children:"double underscore"}),") are special methods whose names start and end with ",(0,t.jsx)(n.code,{children:"__"}),", like ",(0,t.jsx)(n.code,{children:"__init__"}),", ",(0,t.jsx)(n.code,{children:"__str__"}),", or ",(0,t.jsx)(n.code,{children:"__len__"}),".",(0,t.jsx)(n.br,{}),"\n","They let your classes hook into Python\u2019s built\u2011in behavior:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__init__"})," \u2014 called when you create an instance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__str__"})," \u2014 what ",(0,t.jsx)(n.code,{children:"print(obj)"})," shows"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__len__"})," \u2014 what ",(0,t.jsx)(n.code,{children:"len(obj)"})," returns"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__getitem__"})," \u2014 how ",(0,t.jsx)(n.code,{children:"obj[key]"})," works"]}),"\n",(0,t.jsxs)(n.li,{children:["Arithmetic like ",(0,t.jsx)(n.code,{children:"+"}),", ",(0,t.jsx)(n.code,{children:"-"}),", ",(0,t.jsx)(n.code,{children:"*"}),", comparison operators, iteration, and more"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["You rarely call dunder methods directly. Instead, Python calls them ",(0,t.jsx)(n.strong,{children:"for you"})," when you use normal syntax."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"len(obj)        # calls obj.__len__()\nstr(obj)        # calls obj.__str__()\nobj[0]          # calls obj.__getitem__(0)\nobj == other    # calls obj.__eq__(other)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Adding the right dunder methods makes your classes feel like ",(0,t.jsx)(n.strong,{children:"natural, built-in types"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"why-this-matters",children:"Why this matters"}),"\n",(0,t.jsx)(n.p,{children:"Dunder methods let you:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Make your objects ",(0,t.jsx)(n.strong,{children:"print nicely"})," (easier to debug and log)"]}),"\n",(0,t.jsxs)(n.li,{children:["Work with built-in functions (",(0,t.jsx)(n.code,{children:"len"}),", ",(0,t.jsx)(n.code,{children:"iter"}),", ",(0,t.jsx)(n.code,{children:"reversed"}),", ",(0,t.jsx)(n.code,{children:"sorted"}),", \u2026)"]}),"\n",(0,t.jsxs)(n.li,{children:["Support familiar syntax (",(0,t.jsx)(n.code,{children:"[]"}),", ",(0,t.jsx)(n.code,{children:"in"}),", arithmetic operators)"]}),"\n",(0,t.jsx)(n.li,{children:"Integrate with Python protocols (iteration, context managers, numeric types)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You don\u2019t need to memorize all of them. Start with a handful that make your classes easier to use and debug, then learn more as you need them."}),"\n",(0,t.jsxs)(n.h2,{id:"object-construction-__init__",children:["Object construction: ",(0,t.jsx)(n.code,{children:"__init__"})]}),"\n",(0,t.jsxs)(n.p,{children:["You\u2019ve already seen ",(0,t.jsx)(n.code,{children:"__init__"})," in earlier sections. It runs after a new instance is created and is used to initialize attributes:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class User:\n    def __init__(self, username, active=True):\n        self.username = username\n        self.active = active\n\nu = User("alice")\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'User("alice")'})," \u2192 Python creates a new ",(0,t.jsx)(n.code,{children:"User"})," instance, then calls ",(0,t.jsx)(n.code,{children:'User.__init__(that_instance, "alice")'}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["You don\u2019t return anything from ",(0,t.jsx)(n.code,{children:"__init__"}),"\u2014it must return ",(0,t.jsx)(n.code,{children:"None"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"string-representation-__repr__-and-__str__",children:["String representation: ",(0,t.jsx)(n.code,{children:"__repr__"})," and ",(0,t.jsx)(n.code,{children:"__str__"})]}),"\n",(0,t.jsxs)(n.p,{children:["Two of the most useful dunder methods are ",(0,t.jsx)(n.code,{children:"__repr__"})," and ",(0,t.jsx)(n.code,{children:"__str__"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__repr__(self)"})," \u2014 unambiguous representation for developers (used by ",(0,t.jsx)(n.code,{children:"repr(obj)"})," and the interactive shell)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"__str__(self)"})," \u2014 human\u2011friendly string (used by ",(0,t.jsx)(n.code,{children:"str(obj)"})," and ",(0,t.jsx)(n.code,{children:"print(obj)"}),")."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If you only define ",(0,t.jsx)(n.code,{children:"__repr__"}),", Python will fall back to it for ",(0,t.jsx)(n.code,{children:"str()"})," in many contexts."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class Point:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\n    def __repr__(self):\n        return f"Point(x={self.x}, y={self.y})"\n\n    def __str__(self):\n        return f"({self.x}, {self.y})"\n\np = Point(2, 3)\nprint(p)          # (2, 3)\nprint(repr(p))    # Point(x=2, y=3)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Good ",(0,t.jsx)(n.code,{children:"__repr__"})," output makes debugging and logging much easier."]}),"\n",(0,t.jsxs)(n.h2,{id:"container-behavior-__len__-__getitem__-__contains__",children:["Container behavior: ",(0,t.jsx)(n.code,{children:"__len__"}),", ",(0,t.jsx)(n.code,{children:"__getitem__"}),", ",(0,t.jsx)(n.code,{children:"__contains__"})]}),"\n",(0,t.jsx)(n.p,{children:"If your class behaves like a sequence or collection, implement the basic container protocol."}),"\n",(0,t.jsx)(n.h3,{id:"__len__",children:(0,t.jsx)(n.code,{children:"__len__"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"len(obj)"})," calls ",(0,t.jsx)(n.code,{children:"obj.__len__()"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class TodoList:\n    def __init__(self):\n        self._items = []\n\n    def add(self, title):\n        self._items.append(title)\n\n    def __len__(self):\n        return len(self._items)\n\ntodos = TodoList()\ntodos.add("Write docs")\ntodos.add("Review PRs")\nprint(len(todos))  # 2\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"__getitem__-and-iteration",children:[(0,t.jsx)(n.code,{children:"__getitem__"})," and iteration"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"obj[index]"})," calls ",(0,t.jsx)(n.code,{children:"obj.__getitem__(index)"}),".",(0,t.jsx)(n.br,{}),"\n","If you implement ",(0,t.jsx)(n.code,{children:"__getitem__"})," with integer indices starting at 0, your object can often be iterated over automatically:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class TodoList:\n    def __init__(self):\n        self._items = []\n\n    def add(self, title):\n        self._items.append(title)\n\n    def __len__(self):\n        return len(self._items)\n\n    def __getitem__(self, index):\n        return self._items[index]\n\ntodos = TodoList()\ntodos.add("Write docs")\ntodos.add("Fix bugs")\n\nprint(todos[0])  # "Write docs"\n\nfor item in todos:      # uses __getitem__ and __len__\n    print(item)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["For more control over iteration (especially for non-indexable data), you can implement ",(0,t.jsx)(n.code,{children:"__iter__"}),", but ",(0,t.jsx)(n.code,{children:"__getitem__"})," is often enough for simple cases."]}),"\n",(0,t.jsx)(n.h3,{id:"__contains__",children:(0,t.jsx)(n.code,{children:"__contains__"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"x in obj"})," calls ",(0,t.jsx)(n.code,{children:"obj.__contains__(x)"})," if defined:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class TodoList:\n    # ... as above ...\n\n    def __contains__(self, title):\n        return title in self._items\n\n"Write docs" in todos   # True\n"Go to gym" in todos    # False\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"operator-overloading-__add__-__eq__-etc",children:["Operator overloading: ",(0,t.jsx)(n.code,{children:"__add__"}),", ",(0,t.jsx)(n.code,{children:"__eq__"}),", etc."]}),"\n",(0,t.jsxs)(n.p,{children:["Dunder methods also power operators like ",(0,t.jsx)(n.code,{children:"+"}),", ",(0,t.jsx)(n.code,{children:"-"}),", ",(0,t.jsx)(n.code,{children:"=="}),", ",(0,t.jsx)(n.code,{children:"<"}),", and more."]}),"\n",(0,t.jsx)(n.p,{children:"Use this carefully\u2014operator overloading should follow clear, intuitive rules."}),"\n",(0,t.jsxs)(n.h3,{id:"equality-__eq__",children:["Equality: ",(0,t.jsx)(n.code,{children:"__eq__"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class Point:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\n    def __eq__(self, other):\n        if not isinstance(other, Point):\n            return NotImplemented\n        return (self.x, self.y) == (other.x, other.y)\n\np1 = Point(1, 2)\np2 = Point(1, 2)\nprint(p1 == p2)  # True\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Returning ",(0,t.jsx)(n.code,{children:"NotImplemented"})," lets Python try the reverse comparison or fall back gracefully."]}),"\n",(0,t.jsxs)(n.h3,{id:"addition-__add__",children:["Addition: ",(0,t.jsx)(n.code,{children:"__add__"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class Vector2D:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\n    def __add__(self, other):\n        if not isinstance(other, Vector2D):\n            return NotImplemented\n        return Vector2D(self.x + other.x, self.y + other.y)\n\n    def __repr__(self):\n        return f"Vector2D({self.x}, {self.y})"\n\nv1 = Vector2D(1, 2)\nv2 = Vector2D(3, 4)\nprint(v1 + v2)   # Vector2D(4, 6)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["You can also implement other arithmetic methods like ",(0,t.jsx)(n.code,{children:"__sub__"}),", ",(0,t.jsx)(n.code,{children:"__mul__"}),", and their \u201cright-hand\u201d versions (",(0,t.jsx)(n.code,{children:"__radd__"}),", etc.) when needed."]}),"\n",(0,t.jsxs)(n.h2,{id:"making-your-class-iterable-__iter__",children:["Making your class iterable: ",(0,t.jsx)(n.code,{children:"__iter__"})]}),"\n",(0,t.jsxs)(n.p,{children:["To control iteration explicitly, implement ",(0,t.jsx)(n.code,{children:"__iter__"})," and optionally ",(0,t.jsx)(n.code,{children:"__next__"})," (on a separate iterator object)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class Countdown:\n    def __init__(self, start):\n        self.start = start\n\n    def __iter__(self):\n        current = self.start\n        while current > 0:\n            yield current\n            current -= 1\n\nfor n in Countdown(3):\n    print(n)\n# 3\n# 2\n# 1\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.code,{children:"yield"})," inside ",(0,t.jsx)(n.code,{children:"__iter__"})," is a simple way to create an iterator without writing a separate class."]}),"\n",(0,t.jsxs)(n.h2,{id:"context-managers-__enter__-and-__exit__",children:["Context managers: ",(0,t.jsx)(n.code,{children:"__enter__"})," and ",(0,t.jsx)(n.code,{children:"__exit__"})]}),"\n",(0,t.jsxs)(n.p,{children:["Context managers let you use the ",(0,t.jsx)(n.code,{children:"with"})," statement to manage resources (files, locks, database connections, etc.)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class ManagedResource:\n    def __enter__(self):\n        print("Acquiring resource")\n        return self\n\n    def __exit__(self, exc_type, exc, tb):\n        print("Releasing resource")\n        # return True to suppress the exception, or False/None to propagate it\n        return False\n\nwith ManagedResource() as r:\n    print("Inside with block")\n'})}),"\n",(0,t.jsx)(n.p,{children:"Output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Acquiring resource\nInside with block\nReleasing resource\n"})}),"\n",(0,t.jsx)(n.p,{children:"Files use this protocol internally, which is why you can write:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'with open("data.txt", "r", encoding="utf-8") as f:\n    contents = f.read()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"when-and-when-not-to-use-dunder-methods",children:"When (and when not) to use dunder methods"}),"\n",(0,t.jsx)(n.p,{children:"Use dunder methods when:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Your class naturally behaves like a ",(0,t.jsx)(n.strong,{children:"built-in type"})," (sequence, mapping, number, context manager)."]}),"\n",(0,t.jsxs)(n.li,{children:["You want to improve ",(0,t.jsx)(n.strong,{children:"debugging"})," and ",(0,t.jsx)(n.strong,{children:"logging"})," with a good ",(0,t.jsx)(n.code,{children:"__repr__"}),"/",(0,t.jsx)(n.code,{children:"__str__"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"You need your objects to work with Python\u2019s built-in functions and syntax."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Be cautious when:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Overloading operators in ways that ",(0,t.jsx)(n.strong,{children:"surprise"})," other developers."]}),"\n",(0,t.jsx)(n.li,{children:"Implementing many dunder methods without a clear, consistent mental model."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"As a rule of thumb:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Start with ",(0,t.jsx)(n.code,{children:"__repr__"})," (and optionally ",(0,t.jsx)(n.code,{children:"__str__"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["Add ",(0,t.jsx)(n.code,{children:"__len__"}),", ",(0,t.jsx)(n.code,{children:"__iter__"}),", ",(0,t.jsx)(n.code,{children:"__getitem__"}),", or ",(0,t.jsx)(n.code,{children:"__contains__"})," if your object is a collection."]}),"\n",(0,t.jsxs)(n.li,{children:["Add arithmetic or comparison dunders ",(0,t.jsx)(n.strong,{children:"only"})," if they are natural and unambiguous."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"In this guide you learned that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Dunder methods are special hooks that connect your classes to Python\u2019s built\u2011in behavior."}),"\n",(0,t.jsxs)(n.li,{children:["You usually interact with them via normal syntax (",(0,t.jsx)(n.code,{children:"len"}),", ",(0,t.jsx)(n.code,{children:"[]"}),", ",(0,t.jsx)(n.code,{children:"+"}),", ",(0,t.jsx)(n.code,{children:"with"}),", etc.)."]}),"\n",(0,t.jsx)(n.li,{children:"Implementing a few well-chosen dunder methods can make your classes feel like first\u2011class citizens in the language."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"As you build more complex classes, revisit this guide and add dunder methods when they clearly improve your code\u2019s readability and ergonomics. You don\u2019t need all of them\u2014just the ones that make your objects easier to use and reason about."})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(_,{...e})}):_(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function d(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);