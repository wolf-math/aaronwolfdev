"use strict";(globalThis.webpackChunkaaronwolf_dev=globalThis.webpackChunkaaronwolf_dev||[]).push([[5754],{241:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>t,contentTitle:()=>m,default:()=>d,frontMatter:()=>l,metadata:()=>n,toc:()=>c});var n=a(9432),r=a(4848),i=a(8453);const l={slug:"encryption2",title:"Encryption Part 2: Diffie-Hellman",authors:["wolf"],tags:["encryption","python"]},m=void 0,t={authorsImageUrls:[void 0]},c=[{value:"History",id:"history",level:2},{value:"Diffie-Hellman",id:"diffie-hellman",level:2},{value:"How does it work conceptually?",id:"how-does-it-work-conceptually",level:2},{value:"How does the math work?",id:"how-does-the-math-work",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Helper functions",id:"helper-functions",level:3},{value:"Implementing Diffie-Hellman",id:"implementing-diffie-hellman",level:3},{value:"Let&#39;s get 2 volunteers",id:"lets-get-2-volunteers",level:3},{value:"Choose numbers",id:"choose-numbers",level:3},{value:"Review so far:",id:"review-so-far",level:3},{value:"Numbers that are known to everyone",id:"numbers-that-are-known-to-everyone",level:4},{value:"Numbers only known to their owners",id:"numbers-only-known-to-their-owners",level:4},{value:"The <code>super</code> key",id:"the-super-key",level:3},{value:"Sending a message",id:"sending-a-message",level:3},{value:"Step 1: encode the message into the computer numeric values",id:"step-1-encode-the-message-into-the-computer-numeric-values",level:4},{value:"Step 2: encrypt message",id:"step-2-encrypt-message",level:4},{value:"Step 3: decrypt message",id:"step-3-decrypt-message",level:4},{value:"Next Step",id:"next-step",level:2}];function h(e){const s={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msup:"msup",mtext:"mtext",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["This blog post was originally published on ",(0,r.jsx)(s.a,{href:"https://dev.to/wolfmath/series/22067",children:"dev.to"})]})}),"\n",(0,r.jsx)(s.h2,{id:"history",children:"History"}),"\n",(0,r.jsx)(s.p,{children:"The most advanced method of encryption during WWII (the enigma machine) was broken by a guy who built a computer (Alan Turing)."}),"\n",(0,r.jsx)(s.p,{children:"In the decades following WWII the US was in a cold war with the USSR. Computers were being built in order to gain intelligence and monitor what the Soviets were doing. NORAD (part of the US and Canada's military complex) created the first networked computer system and they wanted secure communication so that no bad actors could eavesdrop on secret military communication."}),"\n",(0,r.jsx)(s.h2,{id:"diffie-hellman",children:"Diffie-Hellman"}),"\n",(0,r.jsxs)(s.p,{children:["In 1976 Whitfield Diffie and Martin Hellman developed a method of key exchange where two parties could share ",(0,r.jsx)(s.strong,{children:"public keys"})," for encryption and decryption but nobody else would be able to see any messages because each party would also have a ",(0,r.jsx)(s.strong,{children:"private keys"})]}),"\n",(0,r.jsxs)(s.p,{children:["The Diffie-Hellman key exchange was the first ever devised ",(0,r.jsx)(s.em,{children:"asymmetric cipher"}),". This means that a secret message can be sent from one party to another without the need to share the keys."]}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["The basics of this methodology are still used today in many forms of communication, including SSH. Never ",(0,r.jsx)(s.strong,{children:"EVER"})," share your private key with anybody!"]})}),"\n",(0,r.jsx)(s.h2,{id:"how-does-it-work-conceptually",children:"How does it work conceptually?"}),"\n",(0,r.jsxs)(s.p,{children:["Up until Diffie-Hellman all encryption was done with a ",(0,r.jsx)(s.em,{children:"symmetric"})," key exchange. This means that the sender and receiver had to share an agreed upon key before they can send messages to one another. But what if the 2 parties have never met? Or what if they're far away?"]}),"\n",(0,r.jsxs)(s.p,{children:["The solution is a public key exchange. This is called ",(0,r.jsx)(s.em,{children:"asymmetric"})," key exchange because each party has a different key. But how?"]}),"\n",(0,r.jsxs)(s.p,{children:["Each party has a private key and a public key. The private key is never shared. Both parties agree (publicly) on a prime modulus and a generator to the modulus. The prime modulus is just a large prime number and the generator is a number that when raised to the power off all numbers up to the prime number ",(0,r.jsx)(s.em,{children:"p"})," (1, 2, 3, ... , p-1 , p), the solution set will include all numbers up to ",(0,r.jsx)(s.em,{children:"p"})," (1, 2, 3, ... , p-1 , p). This allows for the same character to be encrypted to different values."]}),"\n",(0,r.jsx)(s.p,{children:"It's confusing- I know."}),"\n",(0,r.jsx)(s.p,{children:"But when the public keys are exchanged the individuals can calculate their private keys raised to the power of their partner's public key and everything unravels to decrypt itself!"}),"\n",(0,r.jsx)(s.h2,{id:"how-does-the-math-work",children:"How does the math work?"}),"\n",(0,r.jsx)(s.p,{children:"The Diffie-Hellman key exchange algorithm is based on the difficulty of the discrete logarithm problem in modular arithmetic. The basic steps of the protocol involve:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Two parties agree on a large prime number ",(0,r.jsx)(s.em,{children:"p"})," and a base ",(0,r.jsx)(s.em,{children:"g"}),", where ",(0,r.jsx)(s.em,{children:"g"})," is a primitive root modulo ",(0,r.jsx)(s.em,{children:"p"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Each party selects a private key (a secret number), let's say ",(0,r.jsx)(s.em,{children:"a"})," and ",(0,r.jsx)(s.em,{children:"b"}),", and  computes their respective public keys as ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"A"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"g"}),(0,r.jsx)(s.mi,{children:"a"})]}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"A = g^{a} mod(p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.6644em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(s.span,{className:"mord mtight",children:(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"})})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})," and ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"B"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"g"}),(0,r.jsx)(s.mi,{children:"b"})]}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"B = g^{b} mod(p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.0991em",verticalAlign:"-0.25em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.8491em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(s.span,{className:"mord mtight",children:(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"b"})})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"They then exchange their public keys."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Each party raises the received public key to the power of their own private key to compute the shared secret: ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"s"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"B"}),(0,r.jsx)(s.mi,{children:"a"})]}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"s = B^{a} mod(p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.6644em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(s.span,{className:"mord mtight",children:(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"})})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})," and ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"s"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"A"}),(0,r.jsx)(s.mi,{children:"b"})]}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"s = A^{b} mod(p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.0991em",verticalAlign:"-0.25em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.8491em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(s.span,{className:"mord mtight",children:(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"b"})})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Due to the properties of modular exponentiation, both parties arrive at the same shared secret."}),"\n",(0,r.jsx)(s.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,r.jsxs)(s.p,{children:["This is a MarkDown version of a Jupyter Notebook that I created for this demonstration. Feel free to ",(0,r.jsx)(s.a,{href:"https://github.com/wolf-math/encryption-demo",children:"clone the repository"})," and play with the key exchange yourself."]}),"\n",(0,r.jsx)(s.h3,{id:"helper-functions",children:"Helper functions"}),"\n",(0,r.jsx)(s.p,{children:"These are not the most performant functions but that's not their intention. They are here so that the user can gain an understanding of how the encryption takes place."}),"\n",(0,r.jsx)(s.p,{children:"First we need a function that tells us if a number is prime or not. This is because our modulus must be a prime number"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# checks if number is prime or not\n\ndef is_prime(number):\n    factors = []\n    for i in range(2, int(number**0.5)+1):\n        if (number/i)%1 == 0:\n            factors.append(i)\n            \n    if len(factors) > 0:\n        return False\n    else:\n        return True\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Given a prime number ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsx)(s.mrow,{children:(0,r.jsx)(s.mi,{children:"p"})}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"p"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"})]})})]}),", the following function returns an array of all numbers that are ",(0,r.jsx)(s.strong,{children:"primitive roots"})," or ",(0,r.jsx)(s.strong,{children:"generators"})," of ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsx)(s.mrow,{children:(0,r.jsx)(s.mi,{children:"p"})}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"p"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"})]})})]}),". A primitive root is a number ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsx)(s.mrow,{children:(0,r.jsx)(s.mi,{children:"a"})}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"a"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"a"})]})})]})," such that if you raise ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsx)(s.mrow,{children:(0,r.jsx)(s.mi,{children:"a"})}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"a"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"a"})]})})]})," to all of the powers ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mn,{children:"2"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mn,{children:"3"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"(1, 2, 3, ... , p)"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord",children:"1"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"2"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"3"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"..."}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})})]})," the results will contain of the numbers ",(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mn,{children:"1"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mn,{children:"2"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mn,{children:"3"}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"."}),(0,r.jsx)(s.mo,{separator:"true",children:","}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"(1, 2, 3, ... , p)"})]})})}),(0,r.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord",children:"1"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"2"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"3"}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord",children:"..."}),(0,r.jsx)(s.span,{className:"mpunct",children:","}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})})]}),", though not necessarily in order."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# returns array of generators of a prime number\n\ndef calculate_generator(prime):\n    if is_prime(prime) == False:\n        return False\n\n    generators = []\n  \n    for i in range(2, prime):\n        results = []\n        for j in range(2, prime):\n            results.append(pow(i, j, prime))\n\n        if len(set(results)) == len(results):\n            generators.append(i)\n\n    return generators\n"})}),"\n",(0,r.jsx)(s.p,{children:"Given a private key (usually a random number), the public key is determined by the following arithmetic function."}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"b"}),(0,r.jsx)(s.mi,{children:"l"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"c"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mi,{children:"g"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"a"}),(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"v"}),(0,r.jsx)(s.mi,{children:"a"}),(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"})]})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mtext,{children:"\xa0"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"public\\_key = generator^{private\\_key} (mod\\ p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.0044em",verticalAlign:"-0.31em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"b"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"c"}),(0,r.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"ey"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.1491em",verticalAlign:"-0.25em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"a"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.8991em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"v"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"e"}),(0,r.jsx)(s.span,{className:"mord mtight",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"ey"})]})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mspace",children:"\xa0"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# creates public key\n\ndef create_pub_key(generator, private_key, prime):\n    # pow takes (base, exp, mod=None) \n    # is equivalent to base**exp % mod\n    return pow(generator, private_key, prime)\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.em,{children:"Encoding"})," is ",(0,r.jsx)(s.strong,{children:"not"})," ",(0,r.jsx)(s.em,{children:"encryption"}),". It simply converts the letter to its computer numerical value. Any computer can make this conversion, so it's not scrambled in any way. This function takes a string as an argument and returns an array of the encoded characters."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# encode a string into an array of each character's numerical value\n\ndef encode_string(string):\n    char_array = []\n    for char in string:\n        char_array.append(ord(char))\n    return char_array\n"})}),"\n",(0,r.jsx)(s.p,{children:"Decoding is the opposite of encoding. This function is the opposite of the previous one."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'# decode an array of numerical values to their corresponding character\n\ndef decode_string(arr):\n    decoded_arr = []\n    for i in arr:\n        decoded_arr.append(chr(i))\n    return "".join(decoded_arr)\n'})}),"\n",(0,r.jsx)(s.p,{children:'Given a encoded array, a shared "super key", and a prime, we can encrypt the message. This is not technically part of the Diffie-Hellman process. We use the following mathematical function to encrypt each letter in the array, though others may be used.'}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mo,{children:"+"}),(0,r.jsx)(s.mi,{children:"s"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mtext,{children:"\xa0"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"num + super\\_key (mod\\ p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"+"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.06em",verticalAlign:"-0.31em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,r.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"ey"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mspace",children:"\xa0"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# encrypts message\n \ndef encrypt_message(super_key, message_array, prime):\n    encrypted_array = []\n    for num in message_array:\n        encrypted_array.append(num + super_key % prime)\n    return encrypted_array\n"})}),"\n",(0,r.jsx)(s.p,{children:"Decrypting the message is the inverse function:"}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"n"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mo,{children:"\u2212"}),(0,r.jsx)(s.mi,{children:"s"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mtext,{children:"\xa0"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"num - super\\_key (mod\\ p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.06em",verticalAlign:"-0.31em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,r.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"ey"}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mspace",children:"\xa0"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# decrypts message\n\ndef decrypt_message(super_key, encrypted_array, prime):\n    decrypted_message = []\n    for num in encrypted_array:\n        decrypted_message.append(num - super_key % prime)\n    return decrypted_message\n"})}),"\n",(0,r.jsx)(s.h3,{id:"implementing-diffie-hellman",children:"Implementing Diffie-Hellman"}),"\n",(0,r.jsx)(s.p,{children:"Now that we have all of our helper functions we can implement Diffie-Hellman. Obviously, this would be done from two different machines if it was sent over the internet (i.e. SSH)."}),"\n",(0,r.jsx)(s.h3,{id:"lets-get-2-volunteers",children:"Let's get 2 volunteers"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'p1 = input("Person 1\'s name: ")\np2 = input("Person 2\'s name: ")\n'})}),"\n",(0,r.jsx)(s.h3,{id:"choose-numbers",children:"Choose numbers"}),"\n",(0,r.jsxs)(s.p,{children:["We need to do is choose a ",(0,r.jsx)(s.strong,{children:"publicly known prime number"}),", and a ",(0,r.jsx)(s.strong,{children:"generator"})," of that prime. In the video the prime was 17 and the generator was 3."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'prime = int(input("choose a shared prime number: "))\n\nwhile is_prime(prime) == False:\n    prime = int(input("that\'s not prime, try again: "))\n\ngen = int(input(f"select a shared generator from the list {calculate_generator(prime)}: "))\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Choose a ",(0,r.jsx)(s.strong,{children:"private key"})," then autogenerate the ",(0,r.jsx)(s.strong,{children:"public key"})]}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"b"}),(0,r.jsx)(s.mi,{children:"l"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"c"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.msup,{children:[(0,r.jsx)(s.mi,{children:"g"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"v"}),(0,r.jsx)(s.mi,{children:"a"}),(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"k"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"y"})]})]}),(0,r.jsx)(s.mo,{stretchy:"false",children:"("}),(0,r.jsx)(s.mi,{children:"m"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mtext,{children:"\xa0"}),(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"public\\_key = g^{private\\_key} (mod\\ p)"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.0044em",verticalAlign:"-0.31em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"b"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"c"}),(0,r.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"ey"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1.1491em",verticalAlign:"-0.25em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.8991em"},children:(0,r.jsxs)(s.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"v"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"e"}),(0,r.jsx)(s.span,{className:"mord mtight",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"ey"})]})})]})})})})})]}),(0,r.jsx)(s.span,{className:"mopen",children:"("}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"m"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mspace",children:"\xa0"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'p1private_key = int(input(f"{p1} select a private key: "))\np1public_key = create_pub_key(gen, p1private_key, prime)\nprint(f"{p1}\'s public key: {p1public_key}")\n\np2private_key = int(input(f"{p2} select a private key: "))\np2public_key = create_pub_key(gen, p2private_key, prime)\nprint(f"{p2}\'s public key: {p2public_key}")\n'})}),"\n",(0,r.jsx)(s.h3,{id:"review-so-far",children:"Review so far:"}),"\n",(0,r.jsx)(s.h4,{id:"numbers-that-are-known-to-everyone",children:"Numbers that are known to everyone"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'print(f"prime number {prime}")\nprint(f"generator of {prime}: {gen}")\nprint(f"{p1}\'s public key {p1public_key}")\nprint(f"{p2}\'s public key {p2public_key}")\n'})}),"\n",(0,r.jsx)(s.h4,{id:"numbers-only-known-to-their-owners",children:"Numbers only known to their owners"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'print(f"{p1}\'s private key {p1private_key}")\nprint(f"{p2}\'s private key {p2private_key}")\n'})}),"\n",(0,r.jsxs)(s.h3,{id:"the-super-key",children:["The ",(0,r.jsx)(s.code,{children:"super"})," key"]}),"\n",(0,r.jsx)(s.p,{children:"The super key is the super-secret key that both parties calculate on their own but with different numbers. They should be equal otherwise this won't work. In the video the super key was 10"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'super_key = pow(p2public_key, p1private_key, prime)\nsuper_key2 = pow(p1public_key, p2private_key, prime)\n\nif super_key != super_key2:\n    print("Oops, something went wrong...")\n    \nprint(f"super key: {super_key}")\n'})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"print(super_key)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"sending-a-message",children:"Sending a message"}),"\n",(0,r.jsx)(s.h4,{id:"step-1-encode-the-message-into-the-computer-numeric-values",children:"Step 1: encode the message into the computer numeric values"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'message = input(f"{p1}, what message do you want to send to {p2}? ")\nmessage_array = encode_string(message)\nprint(message_array)\n'})}),"\n",(0,r.jsx)(s.h4,{id:"step-2-encrypt-message",children:"Step 2: encrypt message"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"encrypted = encrypt_message(super_key, message_array, prime)\nprint(encrypted)\n"})}),"\n",(0,r.jsx)(s.h4,{id:"step-3-decrypt-message",children:"Step 3: decrypt message"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"decrypted = decrypt_message(super_key2, encrypted, prime)\nprint(decode_string(decrypted))\n"})}),"\n",(0,r.jsx)(s.h2,{id:"next-step",children:"Next Step"}),"\n",(0,r.jsx)(s.p,{children:"We learn how RSA encryption works!!!"})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>l,x:()=>m});var n=a(6540);const r={},i=n.createContext(r);function l(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function m(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:s},e.children)}},9432:e=>{e.exports=JSON.parse('{"permalink":"/blog/encryption2","editUrl":"https://github.com/wolf-math/aaronwolfdev/tree/main/blog/2023-12-04-encryption-part-2.md","source":"@site/blog/2023-12-04-encryption-part-2.md","title":"Encryption Part 2: Diffie-Hellman","description":"This blog post was originally published on dev.to","date":"2023-12-04T00:00:00.000Z","tags":[{"inline":false,"label":"encryption","permalink":"/blog/tags/encryption","description":"encryption articles"},{"inline":false,"label":"python","permalink":"/blog/tags/python","description":"python articles"}],"readingTime":7.01,"hasTruncateMarker":true,"authors":[{"name":"Aaron wolf","title":"Lead writer and developer","url":"https://aaronwolf.dev","page":{"permalink":"/blog/authors/wolf"},"socials":{"linkedin":"https://www.linkedin.com/in/wolf-math/","github":"https://github.com/wolf-math"},"imageURL":"https://avatars.githubusercontent.com/u/29966332?v=4","key":"wolf"}],"frontMatter":{"slug":"encryption2","title":"Encryption Part 2: Diffie-Hellman","authors":["wolf"],"tags":["encryption","python"]},"unlisted":false,"prevItem":{"title":"Encryption Part 3: RSA","permalink":"/blog/encryption3"},"nextItem":{"title":"Encryption Part 1: Overview","permalink":"/blog/encryption1"}}')}}]);